[build-system]
requires = ["setuptools>=42"]
build-backend = "setuptools.build_meta"


[tool.cibuildwheel]
# we only build on one python version since the wheels are not bound to it
build = "cp312-*"
# Print system info before build
before-all = "uname -a"
# Can't list requests under build-system.requires because that step happens _after_ the before-build command
before-build = "pip install requests && python download-wgpu-native.py"
# This is sufficient to trigger an install of the built wheel
test-command = "echo Wheel installed"

[tool.cibuildwheel.windows]
# Only for local use, overridden in cd.yml
archs = ["amd64"]

[tool.cibuildwheel.macos]
# Only for local use, overridden in cd.yml
archs = ["arm64"]

[tool.cibuildwheel.linux]
# wgpu-native does not build for musllinux yet
skip = "*musllinux*"
# Use custom images, with minimal version that matches wgpu-native
manylinux-x86_64-image = "quay.io/pypa/manylinux_2_28_x86_64"
manylinux-aarch64-image = "quay.io/pypa/manylinux_2_28_aarch64"
manylinux-i686-image = "quay.io/pypa/manylinux_2_28_i686"
manylinux-ppc64le-image = "quay.io/pypa/manylinux_2_28_ppc64le"
